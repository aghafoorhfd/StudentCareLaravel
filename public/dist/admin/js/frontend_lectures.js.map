{"version":3,"sources":["webpack:///./resources/admin/js/frontend_lectures.js","webpack:///./resources/admin/js/components/file-picker.vue?50b8","webpack:///resources/admin/js/components/file-picker.vue","webpack:///./resources/admin/js/components/file-picker.vue","webpack:///./resources/admin/js/components/file-picker.vue?7b59","webpack:///./resources/module/course/admin/lectures.js"],"names":["document","getElementById","CourseLectures","_vm","this","_h","$createElement","_c","_self","staticClass","directives","name","rawName","value","expression","staticStyle","attrs","i18n","choose_file","domProps","on","$event","target","composing","fileName","_v","openUploader","_s","browse","clearFile","clear","_e","window","courseLecturesManagement","Vue","el","data","onEdit","options","sections","course_sections_data","lecture_form","type","id","duration","url","preview_url","file_id","active","display_order","section_form","error","routes","onSaving","lastSection","course_id","lastEditObject","mounted","computed","fileIdType","add_lecture_title","add_lecture","methods","addLesson","section","$","modal","editLesson","row","Object","assign","openSectionForm","e","saveLesson","me","validateLecture","section_id","ajax","store","dataType","success","json","message","bookingCoreApp","showAjaxMessage","lecture","lessons","push","updateLectureData","status","showAjaxError","lecture_id","sectionIndex","_","findIndex","lectureIndex","k","$set","validate","length","saveSection","validateSection","store_section","section_title","components","filePicker","file_picker"],"mappings":"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","file":"/js/frontend_lectures.js","sourcesContent":["import CourseLectures from '../../module/course/admin/lectures.js';\n// Course\nif(document.getElementById('lecture_management')){\n    CourseLectures();\n}\n","import mod from \"-!../../../../node_modules/babel-loader/lib/index.js??ref--4-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./file-picker.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/babel-loader/lib/index.js??ref--4-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./file-picker.vue?vue&type=script&lang=js&\"","<template>\r\n    <div class=\"bravo-file-picker input-group\">\r\n        <input type=\"text\" class=\"form-control\" style=\"background: white\" v-model=\"fileName\" readonly :placeholder=\"i18n.choose_file\">\r\n        <div class=\"input-group-append\" >\r\n            <span class=\"input-group-text\" @click=\"openUploader\">{{i18n.browse}}</span>\r\n            <span class=\"input-group-text text-danger\" v-if=\"value\" @click=\"clearFile\">{{i18n.clear}}</span>\r\n        </div>\r\n    </div>\r\n</template>\r\n<script>\r\n    export default {\r\n        data:function () {\r\n            return {\r\n                file:{\r\n                    file_name:'',\r\n                    file_extension:'',\r\n                },\r\n                i18n:i18n\r\n            }\r\n        },\r\n        props:{\r\n            type:{\r\n                default:'image'\r\n            },\r\n            value:''\r\n        },\r\n        computed:{\r\n            fileName:function () {\r\n                return this.file.file_extension ? this.file.file_name+'.'+this.file.file_extension : this.file.file_name;\r\n            }\r\n        },\r\n        mounted(){\r\n            var me = this;\r\n            if(this.value){\r\n                this.getFile(this.value);\r\n            }\r\n        },\r\n        methods:{\r\n            openUploader:function () {\r\n                var me = this;\r\n                uploaderModal.show({\r\n                    multiple:false,\r\n                    file_type:me.type,\r\n                    onSelect:function (files) {\r\n                        me.file = files[0];\r\n                        me.$emit('input',me.file.id);\r\n                    },\r\n                });\r\n            },\r\n            clearFile:function () {\r\n                this.file ={\r\n                    file_name:'',\r\n                    file_extension:'',\r\n                };\r\n                this.$emit('input','');\r\n            },\r\n            getFile(id){\r\n                var me = this;\r\n                this.file = {\r\n                    file_name:'',\r\n                    file_extension:'',\r\n                };\r\n                $.ajax({\r\n                    url:bookingCore.media.get_file+'?id='+id,\r\n                    dataType:'json',\r\n                    success:function (json) {\r\n                        if(json.id){\r\n                            me.file = json;\r\n                        }else{\r\n                            me.file.file_name = '(ERROR: File not found)';\r\n                            me.$emit('input','');\r\n                        }\r\n                    },\r\n                    error:function (e) {\r\n                        console.log(e);\r\n                        me.file.file_name = '(ERROR: File not found)';\r\n                        me.$emit('input','');\r\n                    }\r\n                })\r\n            }\r\n        },\r\n        watch:{\r\n            value:function(val){\r\n                if(!val){\r\n                    this.file = {\r\n                        file_name:'',\r\n                        file_extension:'',\r\n                    };\r\n                }else{\r\n                    this.getFile(this.value);\r\n                }\r\n            }\r\n        }\r\n\r\n    }\r\n</script>\r\n","import { render, staticRenderFns } from \"./file-picker.vue?vue&type=template&id=acbb9d26&\"\nimport script from \"./file-picker.vue?vue&type=script&lang=js&\"\nexport * from \"./file-picker.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"bravo-file-picker input-group\"},[_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.fileName),expression:\"fileName\"}],staticClass:\"form-control\",staticStyle:{\"background\":\"white\"},attrs:{\"type\":\"text\",\"readonly\":\"\",\"placeholder\":_vm.i18n.choose_file},domProps:{\"value\":(_vm.fileName)},on:{\"input\":function($event){if($event.target.composing){ return; }_vm.fileName=$event.target.value}}}),_vm._v(\" \"),_c('div',{staticClass:\"input-group-append\"},[_c('span',{staticClass:\"input-group-text\",on:{\"click\":_vm.openUploader}},[_vm._v(_vm._s(_vm.i18n.browse))]),_vm._v(\" \"),(_vm.value)?_c('span',{staticClass:\"input-group-text text-danger\",on:{\"click\":_vm.clearFile}},[_vm._v(_vm._s(_vm.i18n.clear))]):_vm._e()])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import Vue from 'vue';\r\nimport file_picker from \"../../../admin/js/components/file-picker\"\r\nexport default function() {\r\n    window.courseLecturesManagement = new Vue({\r\n        el:'#lecture_management',\r\n        data:{\r\n            onEdit:false,\r\n            options:{},\r\n            sections:course_sections_data.sections,\r\n            lecture_form:{\r\n                type:'',\r\n                id:'',\r\n                name:'',\r\n                duration:'',\r\n                url:'',\r\n                preview_url:'',\r\n                file_id:'',\r\n                active:1,\r\n                display_order:0\r\n            },\r\n            section_form:{\r\n                id:'',\r\n                name:'',\r\n                active:1,\r\n                display_order:0\r\n            },\r\n            i18n:course_sections_data.i18n,\r\n            error:[],\r\n            routes:course_sections_data.routes,\r\n            onSaving:false,\r\n            lastSection:false,\r\n            course_id:course_sections_data.id,\r\n            lastEditObject:{}\r\n        },\r\n        mounted:function () {\r\n        },\r\n        computed:{\r\n            fileIdType:function () {\r\n                switch (this.lecture_form.type) {\r\n                    default:\r\n                        return this.lecture_form.type;\r\n                    break;\r\n                }\r\n            },\r\n            add_lecture_title:function () {\r\n                return this.i18n.add_lecture[this.lecture_form.type]\r\n            },\r\n        },\r\n        methods:{\r\n            addLesson:function (type,section) {\r\n                this.lecture_form = {\r\n                    type:type,\r\n                    id:'',\r\n                    name:'',\r\n                    duration:'',\r\n                    url:'',\r\n                    preview_url:'',\r\n                    file_id:'',\r\n                    active:1,\r\n                    display_order:0\r\n                };\r\n                this.lastSection = section;\r\n                this.error = [];\r\n                switch (type) {\r\n                    default:\r\n                        $('#add_lecture_modal').modal('show');\r\n                        break;\r\n                }\r\n\r\n            },\r\n            editLesson:function (row,section) {\r\n                this.lastSection = section;\r\n                this.lecture_form = Object.assign({},row);\r\n                this.lastEditObject = row;\r\n                this.error = [];\r\n\r\n                $('#add_lecture_modal').modal('show');\r\n\r\n            },\r\n            openSectionForm:function (e,section) {\r\n                this.error = [];\r\n                if(section){\r\n                    this.section_form = Object.assign({},section);\r\n                    this.lastSection = section;\r\n                }else{\r\n                    this.section_form = {\r\n                        id:'',\r\n                        name:'',\r\n                        active:1,\r\n                        display_order:0\r\n                    };\r\n                }\r\n                $('#add_section_modal').modal('show');\r\n\r\n            },\r\n            saveLesson:function () {\r\n                var me = this;\r\n                if(me.onSaving) return;\r\n\r\n                if(!this.validateLecture()){\r\n                    return false;\r\n                }\r\n\r\n                me.onSaving = true;\r\n\r\n                var data = Object.assign({},this.lecture_form);\r\n                data.section_id = me.lastSection ? me.lastSection.id : '';\r\n                data.course_id = me.course_id;\r\n                $.ajax({\r\n                    url:this.routes.store,\r\n                    data:data,\r\n                    dataType:'json',\r\n                    type:'post',\r\n                    success:function (json) {\r\n                        me.onSaving = false;\r\n                        if(json.message){\r\n                            bookingCoreApp.showAjaxMessage(json);\r\n                        }\r\n                        if(json.lecture){\r\n                            if(typeof me.lastSection.lessons == 'undefined'){\r\n                                me.lastSection.lessons = [];\r\n                            }\r\n                            me.lastSection.lessons.push(json.lecture);\r\n                        }else{\r\n                            if(me.lastEditObject){\r\n                                me.lastEditObject = data;\r\n                            }\r\n                            me.updateLectureData(data.section_id,data.id,data);\r\n\r\n                        }\r\n                        if(json.status){\r\n                            $('#add_lecture_modal').modal('hide');\r\n                        }\r\n\r\n                    },\r\n                    error:function (e) {\r\n                        me.onSaving = false;\r\n                        bookingCoreApp.showAjaxError(e);\r\n                    }\r\n                })\r\n            },\r\n            updateLectureData:function(section_id,lecture_id,data){\r\n                var sectionIndex  = _.findIndex(this.sections,{id:section_id});\r\n                if(sectionIndex > -1){\r\n                    var lectureIndex = _.findIndex(this.sections[sectionIndex].lessons,{id:lecture_id});\r\n                    if(lectureIndex > -1 ){\r\n                        for(var k in data){\r\n                            this.$set(this.sections[sectionIndex].lessons[lectureIndex],k,data[k]);\r\n                        }\r\n                    }\r\n                }\r\n            },\r\n            validateLecture:function () {\r\n                this.error = [];\r\n                var error = [];\r\n                if(!this.lecture_form.name){\r\n                    error.push(this.i18n.validate.name);\r\n                }\r\n                if(!this.lecture_form.duration){\r\n                    error.push(this.i18n.validate.duration);\r\n                }\r\n                this.error = error;\r\n                if(error.length) return false;\r\n\r\n                return true;\r\n            },\r\n            saveSection:function () {\r\n                var me = this;\r\n                if(me.onSaving) return;\r\n\r\n                if(!this.validateSection()){\r\n                    return false;\r\n                }\r\n\r\n                me.onSaving = true;\r\n\r\n                var data = Object.assign({},this.section_form);\r\n                data.course_id = me.course_id;\r\n                $.ajax({\r\n                    url:this.routes.store_section,\r\n                    data:data,\r\n                    dataType:'json',\r\n                    type:'post',\r\n                    success:function (json) {\r\n                        me.onSaving = false;\r\n                        if(json.message){\r\n                            bookingCoreApp.showAjaxMessage(json);\r\n                        }\r\n\r\n                        if(json.section){\r\n                            me.sections.push(json.section);\r\n                        }else{\r\n                            for(var k in data){\r\n                                me.$set(me.lastSection,k,data[k]);\r\n                            }\r\n                        }\r\n\r\n                        if(json.status){\r\n                            $('#add_lecture_modal').modal('hide');\r\n                        }\r\n                    },\r\n                    error:function (e) {\r\n                        me.onSaving = false;\r\n                        bookingCoreApp.showAjaxError(e);\r\n                    }\r\n                })\r\n            },\r\n            validateSection:function () {\r\n                this.error = [];\r\n                var error = [];\r\n                if(!this.section_form.name){\r\n                    error.push(this.i18n.validate.section_title);\r\n                }\r\n                this.error = error;\r\n                if(error.length) return false;\r\n                return true;\r\n            },\r\n        },\r\n        components:{\r\n            filePicker:file_picker\r\n        }\r\n    });\r\n}\r\n"],"sourceRoot":""}